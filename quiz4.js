var questions = {
  0: {
    question: "Which color here appeals to you the most?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/06/a0/40/06a0405bd3e1e5862c2c1da885efba75.jpg",
        caption: "Purple"
      },
      {
        url: "https://i.pinimg.com/564x/39/95/ef/3995ef14eb1b92593ba0a982e51e5f3c.jpg",
        caption: "Gold"
      },
      {
        url: "https://i.pinimg.com/564x/f9/45/f8/f945f89eebe2aa8f0cfdb708d16d4003.jpg",
        caption: "Green"
      },
      {
        url: "https://i.pinimg.com/564x/4d/e8/89/4de889a02803e22a3291cf31b5ed6843.jpg",
        caption: "Blue"
      },
    ]
  },
  1: {
    question: "It's time to eat. Pick a food.",
    choices: [
      {
        url: "https://i.pinimg.com/564x/9e/4f/be/9e4fbe14d8ab99fb6c05bc2c247a2be3.jpg",
        caption: "Tricolor Dango"
      },
      {
        url: "https://i.pinimg.com/564x/27/ea/14/27ea143d493d87c071241dd89ac47878.jpg",
        caption: "Adeptus' Temptation"
      },
      {
        url: "https://i.pinimg.com/564x/f8/fa/56/f8fa5624b677b192e17d77bcd85b65f9.jpg",
        caption: "Padisarah Pudding"
      },
      {
        url: "https://i.pinimg.com/564x/bf/6d/0a/bf6d0a22488acc4601a78c9b28374569.jpg",
        caption: "Mushroom Pizza"
      },
    ]
  },
  2: {
    question: "Which festival would you like to be a part of?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/47/d6/ac/47d6ac7a90748c270912c3c7efc0f99b.jpg",
        caption: "Irodori Festival"
      },
      {
        url: "https://i.pinimg.com/564x/2d/11/ed/2d11eda7ef7fb1d525a543cf523a78ed.jpg",
        caption: "Lantern Rite"
      },
      {
        url: "https://preview.redd.it/5atln3kkv7n91.png?width=2560&format=png&auto=webp&v=enabled&s=2e0f9aed49b8bfdadf4b5bd621bffa3cc228d32d",
        caption: "Festival Utsava"
      },
      {
        url: "https://i.pinimg.com/564x/af/2f/65/af2f65f699979a5f5e3dbdef17bc798b.jpg",
        caption: "Windblume"
      },
    ]
  },
  3: {
    question: "Which season is your favorite?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/6e/3b/25/6e3b25fa6944c01220df9ae67286d150.jpg",
        caption: "Summer"
      },
      {
        url: "https://i.pinimg.com/564x/2f/6d/ed/2f6ded123691766eeabec30f9ce76e25.jpg",
        caption: "Fall"
      },
      {
        url: "https://i.pinimg.com/564x/44/e3/55/44e355e5c407450afdb47b13db5972ab.jpg",
        caption: "Spring"
      },
      {
        url: "https://i.pinimg.com/564x/d6/c6/16/d6c6167b78c6051abb8d935e1a46c9e2.jpg",
        caption: "Winter"
      },
    ]
  },
  4: {
    question: "Pick a characteristic that best describes you.",
    choices: [
      {
        url: "https://www.happierhuman.com/wp-content/uploads/2022/08/bible-verses-about-diligence.jpg",
        caption: "Diligent"
      },
      {
        url: "https://themuslimtheist.com/wp-content/uploads/2016/07/rational-man-e1469622234706.jpg",
        caption: "Rational"
      },
      {
        url: "https://penntoday.upenn.edu/sites/default/files/2020-02/P-100849-Master-V1-004X.jpg",
        caption: "Smart"
      },
      {
        url: "https://i.pinimg.com/736x/ed/b4/61/edb461ad7bb64b1a78b97760688ec0aa.jpg",
        caption: "Carefree"
      },
    ]
  },
  5: {
    question: "What's your favorite way of transportation?",
    choices: [
      {
        url: "https://genshin.honeyhunterworld.com/img/tut_6014.webp?x91490",
        caption: "Boat"
      },
      {
        url: "https://preview.redd.it/m9afdohux4961.png?width=864&format=png&auto=webp&v=enabled&s=0010d30bb556047fbe1b2d20b67b5b96a9df5581",
        caption: "Carriage"
      },
      {
        url: "https://genshin.honeyhunterworld.com/img/tut_1157.webp?x91490",
        caption: "Teleportation"
      },
      {
        url: "https://preview.redd.it/2lqur3d81hq71.png?width=1080&crop=smart&auto=webp&v=enabled&s=acf1f2e94058d2f478eaaecff90f4086dd7c8ebb",
        caption: "Gliding"
      },
    ]
  },
  6: {
    question: "You have some free time. What do you want to do?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/ba/18/a1/ba18a157318b393052cf9a73bdd4c304.jpg",
        caption: "Arrange flowers in the courtyard"
      },
      {
        url: "https://i.pinimg.com/564x/f9/78/fe/f978feef1d2516f43cf13dd41fdcefd2.jpg",
        caption: "Listen to stories while eating"
      },
      {
        url: "https://i.pinimg.com/564x/50/5e/cc/505ecc23299a620d3e3099e03d075bca.jpg",
        caption: "Read a book"
      },
      {
        url: "https://i.pinimg.com/564x/db/c9/39/dbc939b7b140e4fd8a64195ace83e0e8.jpg",
        caption: "Sing"
      },
    ]  
  },
  7: {
    question: "Pick a soundtrack",
    choices: [
      {
        url: "https://i.pinimg.com/564x/63/a5/c4/63a5c4f162b1251944db5fae779e4d11.jpg",
        caption: "Sakura and Violet Thunder"
      },
      {
        url: "https://i.pinimg.com/564x/af/93/62/af93628c1146977b4f5c309136ed4542.jpg",
        caption: "Jade Moon in One's Cup"
      },
      {
        url: "https://i.pinimg.com/564x/04/44/26/044426af08e449289bc750ef333a4e1a.jpg",
        caption: "Whirling of Leaves and Petals"
      },
      {
        url: "https://i.pinimg.com/564x/a9/cb/ef/a9cbef9d1e311c8672d0c1fed8ea88c2.jpg",
        caption: "The Horizon of Dandelion"
      },
    ]
  },
  8: {
    question: "Which of these archons is your favorite?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/2f/92/8b/2f928bf2b004136169053d5110152d1f.jpg",
        caption: "Raiden Shogun"
      },
      {
        url: "https://i.pinimg.com/564x/20/fa/be/20fabe040a2b6445b29f356a8c78bb3d.jpg",
        caption: "Rex Lapis"
      },
      {
        url: "https://i.pinimg.com/564x/dd/a5/ca/dda5cab72e4640595fa057279c99f3d7.jpg",
        caption: "Lesser Lord Kusanali"
      },
      {
        url: "https://i.pinimg.com/564x/93/67/c7/9367c706d0f36b10d400816b4c236b06.jpg",
        caption: "Barbatos"
      },
    ]
  },
  9: {
    question: "Which of these animals is your favorite?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/35/43/cd/3543cd5693750c5a1bccdbbaa1267ae5.jpg",
        caption: "Fox"
      },
      {
        url: "https://i.pinimg.com/564x/88/fa/22/88fa22efbd191693ad38060df6ba55df.jpg",
        caption: "Crane"
      },
      {
        url: "https://i.pinimg.com/564x/c7/88/3d/c7883dc46e3b039b2bac1b9087be9b5d.jpg",
        caption: "Tiger"
      },
      {
        url: "https://i.pinimg.com/564x/24/1e/ad/241ead6ce35b3be83a38e1ee6ef93f22.jpg",
        caption: "Bird"
      },
    ]
  },
  10: {
    question: "Which flower do you like the best?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/45/32/09/453209039401d6a7229bb2d990eb5517.jpg",
        caption: "Dendrobrium"
      },
      {
        url: "https://i.pinimg.com/564x/29/44/4d/29444d34e051ce3793fdd931497006f8.jpg",
        caption: "Glaze Lily"
      },
      {
        url: "https://genshin.honeyhunterworld.com/img/i_n101219.webp?x91490",
        caption: "Sumeru Rose"
      },
      {
        url: "https://i.pinimg.com/564x/ac/1e/da/ac1eda648393e57b6a79fe7eb8cc4621.jpg",
        caption: "Windwheel Aster"
      },
    ]
  },
  11: {
    question: "Which scenery do you like the best?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/ad/3b/38/ad3b38bf61e4bf5204be13e59b9a3e0f.jpg",
        caption: "Japanese"
      },
      {
        url: "https://i.pinimg.com/564x/11/1e/ff/111effcd6c54ade7230ed156716e57ce.jpg",
        caption: "Chinese"
      },
      {
        url: "https://i.pinimg.com/564x/d0/fc/37/d0fc376f3192fafa67322afa193ec20a.jpg",
        caption: "Sumerian"
      },
      {
        url: "https://i.pinimg.com/564x/94/1c/7c/941c7ce1644d5af68988a36e694e8fcf.jpg",
        caption: "Field"
      },
    ]
  },
  12: {
    question: "What job would you prefer?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/97/96/f5/9796f5a1d3562d5e9ac9c06d86d4c413.jpg",
        caption: "Storyteller"
      },
      {
        url: "https://oishya.com/wp-content/uploads/2019/12/japanese-tea-matcha-ceremony.jpg.webp",
        caption: "Tea Brewer"
      },
      {
        url: "https://i.pinimg.com/564x/1e/5b/42/1e5b42f677b8d0e59007a9df49d4b4da.jpg",
        caption: "Librarian"
      },
      {
        url: "https://i.pinimg.com/564x/f0/05/8d/f0058da8079d1378f6f1f59e15a35bea.jpg",
        caption: "Bard"
      },
    ]
  },
  13: {
    question: "Which fish do you prefer?", 
    choices: [
      {
        url: "https://genshin.honeyhunterworld.com/img/i_2818.webp?x91490",
        caption: "Raimei Angelfish"
      },
      {
        url: "https://genshin.honeyhunterworld.com/img/h_379012.webp?x91490",
        caption: "Golden Koi"
      },
      {
        url: "https://genshin.honeyhunterworld.com/img/i_n131026.webp?x91490",
        caption: "Sunset Cloud Angler"
      },
      {
        url: "https://genshin.honeyhunterworld.com/img/i_2802.webp?x91490",
        caption: "Glazed Medaka"
      },
    ]
  },
  14: {
    question: "Which house are you most likely to live in?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/4c/ef/8f/4cef8f26db861e5cb7d179ec5472a7bd.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/07/ae/c3/07aec3573dce7bb6a0a16659378d6787.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/ed/88/75/ed88756c3524532018072f428d3fde0f.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/37/f4/37/37f4374e55a24809b85e4f2463120c5b.jpg",
        caption: ""
      },
    ]
  },
  15: {
    question: "Which clothing style do you prefer?",
    choices: [
      {
        url: "https://i.pinimg.com/736x/f8/b6/8d/f8b68ddf585fa20283c4b3fb172968ca.jpg",
        caption: "" // mnk wow omgomgogmgsahyfnuiahdj 
      },
      {
        url: "https://i.pinimg.com/564x/f9/0c/66/f90c664a9a03a54ebe06152cd25e3247.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/736x/d4/4c/d3/d44cd3397a99868f85bdf1b1e631ee41.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/1d/f6/6f/1df66f6823c83671251c40be917a9eb5.jpg",
        caption: ""
      },
    ]
  },
  16: {
    question: "Which drink do you prefer?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/2d/c4/9a/2dc49ac11a82e71eb2fda5a20ae12164.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/ed/14/74/ed1474e6b60e034aca352f721fa32236.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/1a/01/ce/1a01ce4c089d84491f49e5b68fb6c5c5.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/9c/00/79/9c007950224b16d58425d274077bf329.jpg",
        caption: ""
      },
    ]
  },
  17: {
    question: "If you had to work, where would you go?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/ff/70/8f/ff708fd1338f697889495f7a0dc00412.jpg",
        caption: "The Shrine"
      },
      {
        url: "https://i.pinimg.com/564x/3f/82/1f/3f821f980cb41343dd8a291b0c6a751d.jpg",
        caption: "Wangshu Inn"
      },
      {
        url: "https://i.pinimg.com/564x/22/24/61/22246136bd12eba8eb8fdee3a9e93bbb.jpg",
        caption: "Pardis Dhyai"
      },
      {
        url: "https://i.pinimg.com/564x/e7/26/47/e7264799783fe4b723d1cc44c08bebb1.jpg",
        caption: "Dawn Winery"
      },
    ]
  },
  18: {
    question: "Who would you like to spend your day with?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/91/eb/23/91eb235f40257ba35d496ef40f71cf2d.jpg",
        caption: "A sparring partner"
      },
      {
        url: "https://i.pinimg.com/564x/59/c3/df/59c3dfb7ca9b35002eef9d716d41085f.jpg",
        caption: "A storyteller"
      },
      {
        url: "https://i.pinimg.com/564x/66/10/b1/6610b174a352bc97a70299779a8b1487.jpg",
        caption: "A scholar"
      },
      {
        url: "https://i.pinimg.com/564x/cf/c8/1e/cfc81e568f03d2568b252822d41f0325.jpg",
        caption: "A bard"
      },
    ]
  },
  19: {
    question: "What local specialty would you spend a day collecting?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/bb/ae/02/bbae022a2a6f10ba429c3d59113f0a90.jpg",
        caption: "Sea Ganoderma"
      },
      {
        url: "https://i.pinimg.com/564x/b4/c3/03/b4c3030e73a7756660de5e96760db481.jpg",
        caption: "Starconch"
      },
      {
        url: "https://i.pinimg.com/564x/2b/63/68/2b63688bdc7593ac0337485a6d166214.jpg",
        caption: "Hanna Berry"
      },
      {
        url: "https://i.pinimg.com/564x/6c/5e/af/6c5eafbd5fa390500b0a1032c5df3006.jpg",
        caption: "Valberry"
      },
    ]
  },
  20: {
    question: "Choose a cake you would like to have for your birthday",
    choices: [
      {
        url: "https://i.pinimg.com/564x/3d/b7/57/3db757cd7edd217b97a637f11096f567.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/736x/ec/18/ea/ec18eaadf94faa1f7cb59adb29a5703c.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/16/ed/c0/16edc0e954ebb02f7a292bc49efa1df5.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/5f/11/5e/5f115e65a3893c51e1e5342163099318.jpg",
        caption: ""
      },
    ]
  },
  21: {
    question: "Which painting do you like the most?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/fd/0a/9f/fd0a9fd64970e7b5b1224549fb46d1ad.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/e6/42/69/e642697ac7aba9642ee5457077365ff9.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/08/bc/c1/08bcc1189982770d242fdebd63b6b9fa.jpg",
        caption: ""
      },
      {
        url: "https://i.pinimg.com/564x/e3/0e/0f/e30e0f30160540be4a5248d791a85b87.jpg",
        caption: ""
      },
    ]
  },
  22: {
    question: "Choose a place to go to for your vacation.",
    choices: [
      {
        url: "https://i.pinimg.com/564x/29/92/0d/29920d7a5201b812fe74efe3291c1e9c.jpg",
        caption: "Japan"
      },
      {
        url: "https://i.pinimg.com/564x/22/e1/70/22e170988ade6362021e5bc7e9279f4a.jpg",
        caption: "China"
      },
      {
        url: "https://i.pinimg.com/564x/c4/58/58/c45858a9fcefb8f4e5eec6a99819b1b3.jpg",
        caption: "India"
      },
      {
        url: "https://i.pinimg.com/564x/7a/96/f0/7a96f0393d0dc39efe97deeb1e0c2747.jpg",
        caption: "Germany"
      },
    ]
  },
  23: {
    question: "What time of the day do you like the most?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/a5/40/3e/a5403e5de7db00a1dd379f9c1a372f61.jpg",
        caption: "Midnight"
      },
      {
        url: "https://i.pinimg.com/564x/e0/d8/9e/e0d89e85c5a365438e2435236925f76d.jpg",
        caption: "Early evening"
      },
      {
        url: "https://i.pinimg.com/564x/e1/bd/4e/e1bd4e43df20e5b40f0ea018e388aa4b.jpg",
        caption: "Afternoon"
      },
      {
        url: "https://i.pinimg.com/564x/b3/ca/52/b3ca52f7bc8af2c2f0573e389cfd31a6.jpg",
        caption: "Morning"
      },
    ]
  },
  24: {
    question: "If you had to make a perfume, what dominant scent would it have?",
    choices: [
      {
        url: "https://i.pinimg.com/564x/06/ad/07/06ad07e45108afa89ecc52f6a829bf3d.jpg",
        caption: "Fresh"
      },
      {
        url: "https://i.pinimg.com/564x/9a/8f/19/9a8f19b253bbe144ce517dcbcf1af5c8.jpg",
        caption: "Woody"
      },
      {
        url: "https://i.pinimg.com/564x/c2/39/cb/c239cb8bcb4e28371ba89dbfc0264d55.jpg",
        caption: "Oriental"
      },
      {
        url: "https://i.pinimg.com/564x/e6/4b/aa/e64baa54501b88af2906c0407e52ea28.jpg",
        caption: "Floral"
      },
    ]
  },
}

/* function for starting the quiz */
const questionNum = 15; //declare number of questions
function startQuiz() {
  const selectedQuestions = getRandom(questions, questionNum); //call a function to generate the numbers
  const main = document.getElementById("qContainer");
  document.getElementById("startQuiz").style.display = "none";
  document.getElementById("mainQuiz").style.display = "flex";

  for (let i = 0; i < selectedQuestions.length; i++) { //loop to make divs with selected questions
    const qDiv = document.createElement("div");
    qDiv.classList.add("question");
    qDiv.innerHTML = "<p>" + questions[selectedQuestions[i]].question + "</p>";
    const choices = document.createElement("div");
    choices.classList.add("choices");
    
    for (let j = 0; j < 4; j++) { //loop for choices
      const imgDiv = document.createElement("div");
      imgDiv.classList.add("imgDiv");
      imgDiv.classList.add("selected");
      if (j == 0) {
        imgDiv.classList.add("inazuma");
      } else if (j == 1) {
        imgDiv.classList.add("liyue");
      } else if (j == 2) {
        imgDiv.classList.add("sumeru");
      } else {
        imgDiv.classList.add("mondstadt");
      }
      const img = document.createElement("img");
      img.classList.add("image")
      const url = questions[selectedQuestions[i]].choices[j].url;
      const captionText = questions[selectedQuestions[i]].choices[j].caption;
      img.src = url;
      img.alt = captionText;
      imgDiv.appendChild(img);
      const caption = document.createElement("p");
      caption.classList.add("choiceCaption");
      caption.innerHTML = captionText;
      imgDiv.appendChild(caption);
      choices.appendChild(imgDiv);
    }
    
    qDiv.appendChild(choices);
    main.appendChild(qDiv);
    main.style.display = "block";
    document.getElementById("pinterestQuiz").style.justifyContent = "flex-start";
  }
  randomizeDivOrder();
  eventListeners();
  smoothScrolling();
  randomBgColor();
  document.getElementById("mainQuiz").style.width = "70%";
  document.getElementById("mainQuiz").style.display = "flex";
  document.getElementById("submitQuiz").style.display = "block";
}

/* random numbers generator */
function getRandom(questions, questionNum) {
  const questionList = Object.keys(questions);
  var selectedQuestions = [];
  var similar;

  /* the loop below randomly selects questions from the questions list */
  for (let i = 0; i < questionNum && questionList.length > 0; i++) {
    var random = Math.floor(Math.random() * questionList.length);
    similar = false;
    for (let j = 0; j < selectedQuestions.length; j++) { //checks for repetition in random numbers
      if (selectedQuestions[j] == random) {
        similar = true;
        break;
      }
    }
    if (similar == false) {
      selectedQuestions.push(random); //if the number was not repeated, it gets pushed into the array
    } else {
      i--; //decrements the loop by 1 if there was a repeated number
    }
  }
return selectedQuestions;
}

/* function to randomize the div order using Fisher-Yates */
function randomizeDivOrder() {
  const choices = document.querySelectorAll(".choices");
  choices.forEach(choice => {
    const imgDivs = Array.from(choice.querySelectorAll(".imgDiv"));
    for (let i = imgDivs.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i+1));
      choice.insertBefore(imgDivs[j], imgDivs[i]);
    }
  });
}
/* event listeners for divs so that once a div is clicked, the other three change opacity */
function eventListeners() {
const parent = document.querySelectorAll(".question");
  
parent.forEach((question, index) => {
  const choices = question.querySelectorAll(".choices .imgDiv");

  choices.forEach(choice => {
    choice.addEventListener("click", () => {
      choice.classList.add("selected");
      choice.classList.remove("deselected");
      choices.forEach(otherChoice => {
        if (otherChoice !== choice) {
          otherChoice.classList.add("deselected");
          otherChoice.classList.remove("selected");
        }
      });
    });
  });
});
}
/* for smooth scrolling if user finishes a question */
function smoothScrolling() {
  const choices = document.querySelectorAll(".choices");
  choices.forEach((div) => { 
    div.addEventListener("click", scroll);
  });
}
function scroll(event) {
  var currentDiv = event.target;
  currentDiv = currentDiv.parentElement;
  currentDiv = currentDiv.parentElement;
  currentDiv = currentDiv.parentElement;
  const nextDiv = findNext(currentDiv); //finding the next div to scroll to
  if (nextDiv) {
    nextDiv.scrollIntoView({ behavior: "smooth" });
  }
}
function findNext(currentDiv) {
  const questions = document.querySelectorAll(".question");
  let current = Array.from(questions).indexOf(currentDiv);
  for (let i = current + 1; i < questions.length; i++) {
    if (questions[i].classList.contains("question")) {
      return questions[i-1];
    }
  }
  return null;
}
/* for assigning each div with a random background color */
function randomBgColor() {
  const colors = ["#3d3091", "#21cfb5", "#6505b3", "#ba023f", "#219e5e", "#edcd64", "#edcd64", "#bfb5aa", "#63cfb4", "#ab3232", "#f2d75e"];
  const divs = document.querySelectorAll(".question");

  divs.forEach(function(div) {
    const randomColor = colors[Math.floor(Math.random() * colors.length)];
    div.style.backgroundColor = randomColor;
  });
}

/* for checking the completion of inputs */
function checkQuizInput() {
  const questions = document.querySelectorAll(".question");
  
  if (confirm("Are you sure?")) {
    var found;
    questions.forEach(question => {
      const imgDivs = question.querySelectorAll(".imgDiv");
      if (found) {
        return;
      }
      let selected = 0;
      found = false;
      
      imgDivs.forEach(imgDiv => {
        if (imgDiv.classList.contains("selected")) {
          selected++;
        }
      });
      if (selected > 1) { //if more than one imgDiv has class "selected" per question, that means that the question has not been answered yet and the script scrolls to that particular question
        alert("Please fill out all questions.");
        question.scrollIntoView({ behavior: "smooth" });
        found = true;
      }
    });
    if (found !== true) { //if all questions are answered, inputs are evaluated
    calculateInput();
    }
  } else {
    return;
  }
}

/* for calculating input values */
var inazumaCount = 0;
var sumeruCount = 0;
var liyueCount = 0;
var mondstadtCount = 0;

function calculateInput() {
  inazumaCount = 0;
  sumeruCount = 0;
  liyueCount = 0;
  mondstadtCount = 0;
  
  const questionDivs = document.querySelectorAll(".question");
  questionDivs.forEach(question => {
    const imgDivs = question.querySelectorAll(".imgDiv");
    imgDivs.forEach(choice => {
      if (choice.classList.contains("selected")) {
        if (choice.classList.contains("inazuma")) {
          inazumaCount++;
        } else if (choice.classList.contains("sumeru")) {
          sumeruCount++;
        } else if (choice.classList.contains("liyue")) {
          liyueCount++;
        } else if (choice.classList.contains("mondstadt")) {
          mondstadtCount++;
        }
      }
    });
  });
  displayResult();
}

/* for displaying the result on the page */
function displayResult() {
  document.getElementById("mainQuiz").style.display = "none";
  document.getElementById("results").style.display = "flex";

  // to calculate percentages
  var inazumaC = inazumaCount/questionNum;
  var sumeruC = sumeruCount/questionNum;
  var liyueC = liyueCount/questionNum;
  var mondstadtC = mondstadtCount/questionNum;

  // chart with chart.js
  const data = {
    labels: ["Inazuma","Sumeru","Liyue", "Mondstadt"],
    datasets: [{
      label: "  You are",
      data: [inazumaC * 100, sumeruC * 100, liyueC * 100, mondstadtC * 100],
      backgroundColor: [
        "#9F00E4", "#40C900", "#E7E400", "#00E6F1"
      ],
      borderWidth: 8,
      borderColor: "rgba(255,255,255,0.8)",
      hoverOffset: 6
    }]
  };
  
  const config = {
  type: 'doughnut',
  data: data,
  options: {
    borderWidth: 4,
    plugins: {
      tooltip: {
        callbacks:{
          label: function(context) {
            const label = context.dataset.label || " ";
            const value = context.parsed.toFixed(2) + "%";
            const section = context.label || " ";
            return `${label} ${value} from ${section}`;
            }
          }
        },
      legend: {
        display: false
      }
    }
    }
  };

  var chart = new Chart(
    document.getElementById("chart"),
    config
  );

  const ul = document.querySelector("ul");
  // making the ul that stands as a legend for the chart
  
  function populateUl() {
    data.labels.forEach((l, i) => {
      const li = document.createElement("li");
      li.innerHTML = `${l}: <span class="percentage">${data.datasets[0].data[i].toFixed(2)}%</span>`;
      ul.appendChild(li);
    });
  }
  populateUl();
  // calculating for region with most points
  var from = highestRegion(inazumaCount, sumeruCount, liyueCount, mondstadtCount);
  
  // displaying more result info
  const heading = ["Inazuma", "Sumeru", "Liyue", "Mondstadt"];
  const description = ["As an inhabitant from Inazuma, you possess many talents and admirable characteristics. You are known for unwavering determination, resilience, and your expression of what you truly feel with no hesitation. You are deeply committed to your community, and you work to fulfill your strong sense of justice and fairness, making you a great leader and an advocate for change. Most importantly, you are a person of great spirit and strength. No matter what the challenge is, you are one of those people who step up and face it head-on, then coming out stronger. Your courage and resilience is an inspiration for everyone around you, and these traits make you a distinguished member of any community.", /*next*/ "As an inhabitant from Sumeru, you possess great wisdom and a profound understanding of the natural world. You have great attention to detail, and you are always well-prepared for any type of trial that life may throw at you. Your devotion for knowledge is your very strength combined with your bravery to stand up to towering obstacles, you become a person who advances and enriches the lives of other people. It comes as no surprise when many will decide to make you their role model in life.", /*next*/ "As an inhabitant from Liyue, your will and ambition to reach your dreams is unparalleled. Your resilience is as unmovable as the towering mountains that overlook the scenery of Liyue. You may also be described by others as hardworking and a person who considers situations from all perspectives. All of these traits combined makes a person like you a good decision maker and someone who is an unstoppable force when it comes to reaching their goals. Motivation and determination are your assets in life.", /*next*/ "As an inhabitant from Monstadt, freedom and fun is your bread and butter. You are not afraid to try out new things and meet people. Additionally, you tend to enjoy the finer things in life, romanticizing your experiences, and preferring aesthetic over functionality. Your freedom opens the door to an eventful life and encourages new ideas. As such, it is only natural for you to attract people and become the life of the party, often bouncing from one friend group to another. To you, life is short, and must be enjoyed to the fullest. Continue living out your true self without fear and in no time, you will be fulfilled by the simple pleasures of friendships and boundless experiences that get your adrenaline pumping."];
  var resH = document.getElementById("resultHeading");
  var resD = document.getElementById("resultDescription");
  var container = document.getElementsByClassName("container")[0];
  var percent;
  document.getElementById("youAre").innerHTML = "You are from...";
  if (from == inazumaCount) {
    resH.innerHTML = heading[0];
    resD.innerHTML = description[0];
    percent = (inazumaCount/questionNum).toFixed(2);
    container.style.backgroundImage = "url('../images/Genshin/Inazuma.jpg')"
  } else if (from == sumeruCount) {
    resH.innerHTML = heading[1];
    resD.innerHTML = description[1];
    percent = (sumeruCount/questionNum).toFixed(2);
    container.style.backgroundImage = "url('../images/Genshin/Sumeru.jpg')"
  } else if (from == liyueCount) {
    resH.innerHTML = heading[2];
    resD.innerHTML = description[2];
    percent = (liyueCount/questionNum).toFixed(2);
    container.style.backgroundImage = "url('../images/Genshin/Liyue.jpg')"
  } else if (from == mondstadtCount) {
    resH.innerHTML = heading[3];
    resD.innerHTML = description[3];
    percent = (mondstadtCount/questionNum).toFixed(2);
    container.style.backgroundImage = "url('../images/Genshin/Mondstadt.jpg')"
  } 

  var historyInitial = document.getElementById("historyInitial");
  var regionCont = document.getElementById("region");
  var regionPercentCont = document.getElementById("regionPercentage");
  
  if (localStorage.getItem("isLoggedIn")) {
    document.getElementById("resetAttemptHistory").style.display = "bl  ock";
    let attempts = localStorage.getItem("genshinAttempts");
    attempts++;
    localStorage.setItem("genshinAttempts", attempts);
    var saveData = [resH.innerHTML, percent];
    localStorage.setItem("genshinScore" + attempts, JSON.stringify(saveData));
    historyInitial.innerHTML = "View your quiz history below."

    for (let i = 1; i < attempts; i++) {
      const key = "genshinScore" + i;
      const array = JSON.parse(localStorage.getItem(key));
      
      const regionC = document.createElement("p");
      regionC.innerHTML = array[0];
      regionCont.appendChild(regionC);
      
      const regionPC = document.createElement("p");
      regionPC.innerHTML = array[1] * 100 + "%";
      regionPercentCont.appendChild(regionPC);
    }
  } else {
    historyInitial.innerHTML = "To save the results of your next attempt, sign up or log in."
    regionCont.style.display = "none";
    regionPercentCont.style.display = "none";
    document.getElementById("resetAttemptHistory").style.display = "none";
  }
}

// function for highest value out of all the region scores
function highestRegion(a, b, c, d) {
  return Math.max(a, b, c, d);
}

// to completely reset user attempt history
function resetAttemptHistory() {
  var result = confirm("This will wipe out ALL of your attempt histories, including your current one, for this quiz. This can no longer be undone and your data cannot be recovered. If you would like to do so, please click OK");
  let attempts = localStorage.getItem("genshinAttempts");
  if (result) {
    for (let i = 1; i <= attempts; i++) {
      const key = "genshinScore" + i;
      localStorage.removeItem(key);
    }
    attempts = 0;
    localStorage.setItem("genshinAttempts", 0);
    window.location.reload();
  }
}